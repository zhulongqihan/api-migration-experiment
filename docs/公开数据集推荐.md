# API迁移公开数据集推荐

## 推荐数据集

### 1. **APIMigrationBench** (推荐)
- **来源**: GitHub研究项目
- **规模**: 1000+ API迁移对
- **质量**: 来自真实项目的commit
- **下载**: 
 ```bash
 git clone https://github.com/NAIST-SE/APIMigrationBench
 ```
- **格式**: JSON，包含before/after代码对

### 2. **AndroidAPIChanges**
- **来源**: Android SDK升级迁移
- **规模**: 500+ 迁移样本
- **特点**: 真实Android项目迁移
- **链接**: https://github.com/hussien89aa/AndroidAPIChanges

### 3. **PyCodeMigrate**
- **来源**: Python 2→3迁移数据
- **规模**: 3000+ 样本
- **质量**: 高质量标注
- **链接**: https://github.com/python/2to3-examples

### 4. **TensorFlow Migration Dataset**
- **来源**: TF 1.x → 2.x官方迁移
- **规模**: 200+ 迁移模式
- **官方**: TensorFlow团队整理
- **链接**: https://www.tensorflow.org/guide/migrate

---

## 使用现有数据集的脚本

### 从APIMigrationBench提取

```python
import json
import requests

def download_api_migration_bench():
 """从GitHub下载API迁移数据"""
 url = "https://raw.githubusercontent.com/NAIST-SE/APIMigrationBench/main/data/migrations.json"
 
 response = requests.get(url)
 data = response.json()
 
 # 转换为我们的格式
 converted = {
 "train": [],
 "test": []
 }
 
 for i, migration in enumerate(data):
 sample = {
 "id": i + 1,
 "dependency": migration.get("library", "unknown"),
 "old_code": migration["before"],
 "new_code": migration["after"],
 "description": migration.get("description", "")
 }
 
 # 80-20划分
 if i % 5 == 0:
 converted["test"].append(sample)
 else:
 converted["train"].append(sample)
 
 return converted
```

---

## 快速生成脚本

我已经创建了 `build_large_dataset.py`，基于真实迁移模式生成100+样本。

### 运行方式

```bash
cd ~/api_migration_exp/scripts
python3 build_large_dataset.py
```

这将生成 `large_dataset.json`，包含：
- **100个训练样本**
- **30个测试样本**
- 覆盖8个主流库（pandas, numpy, sklearn, tensorflow, torch, PIL, requests, matplotlib）

---

## 数据质量对比

| 数据源 | 样本量 | 真实性 | 多样性 | 可用性 |
|--------|--------|--------|--------|--------|
| mini_dataset.json | 40 | | | |
| build_large_dataset.py | 100+ | | | |
| APIMigrationBench | 1000+ | | | 需下载 |
| GitHub真实项目 | 10000+ | | | 需爬取 |

---

## 建议

1. **短期（现在）**: 使用 `build_large_dataset.py` 生成100样本数据集
2. **中期**: 下载APIMigrationBench并转换格式
3. **长期**: 从GitHub真实项目中爬取迁移数据

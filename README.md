# APIç‰ˆæœ¬è¿ç§»å®éªŒ ğŸš€

## ğŸ“– é¡¹ç›®ç®€ä»‹

æ¢ç´¢åœ¨ä¸é¢‘ç¹å…¨é‡å¾®è°ƒçš„å‰æä¸‹ï¼Œä½¿ä¸­å°è§„æ¨¡ä»£ç æ¨¡å‹åœ¨åŠ¨æ€APIç¯å¢ƒä¸­å¯é åœ°ç”Ÿæˆç¬¦åˆæœ€æ–°ç‰ˆåº“æ¥å£çš„ä»£ç ï¼Œé¿å…æ˜‚è´µçš„æŒç»­å¾®è°ƒä¸ç¾éš¾æ€§é—å¿˜ã€‚

## ğŸ¯ ç ”ç©¶ç›®æ ‡

**æ ¸å¿ƒé—®é¢˜**ï¼šå¦‚ä½•è®©ä»£ç ç”Ÿæˆæ¨¡å‹å¿«é€Ÿé€‚åº”APIç‰ˆæœ¬æ›´æ–°ï¼Ÿ

**è§£å†³æ€è·¯**ï¼š
1. é¿å…é¢‘ç¹å…¨é‡å¾®è°ƒï¼ˆæˆæœ¬é«˜ï¼‰
2. é˜²æ­¢ç¾éš¾æ€§é—å¿˜ï¼ˆä¿æŒå…¶ä»–èƒ½åŠ›ï¼‰
3. å®ç°ç²¾ç¡®çš„çŸ¥è¯†æ›´æ–°ï¼ˆåªæ”¹APIç›¸å…³çŸ¥è¯†ï¼‰

## ğŸ”¬ ä¸‰ä¸ªç ”ç©¶æ–¹å‘ï¼ˆå¹¶è¡Œæ¢ç´¢ï¼‰

### æ–¹å‘1ï¸âƒ£: å¼ºåŒ–å­¦ä¹ /åå¥½å¾®è°ƒï¼ˆåŸºäºReCodeæ”¹è¿›ï¼‰
- **æ ¸å¿ƒæ€æƒ³**ï¼šé€šè¿‡å¥–åŠ±å‡½æ•°å¼•å¯¼æ¨¡å‹å­¦ä¹ æ–°API
- **æŠ€æœ¯æ–¹æ¡ˆ**ï¼šGRPO/DPO + æ”¹è¿›çš„å¥–åŠ±å‡½æ•°
- **åˆ›æ–°ç‚¹**ï¼š
  - å±‚æ¬¡åŒ–LoRAï¼ˆåªæ›´æ–°æ·±å±‚è¯­ä¹‰å±‚ï¼‰
  - æ›´å¥½çš„å¥–åŠ±å‡½æ•°è®¾è®¡ï¼ˆæ‰§è¡ŒæˆåŠŸ + æµ‹è¯•é€šè¿‡ + APIæ­£ç¡®æ€§ï¼‰

### æ–¹å‘2ï¸âƒ£: ç¥ç»çŸ¥è¯†ç¼–è¾‘ï¼ˆä¸»è¦åˆ›æ–°âœ¨ï¼‰
- **æ ¸å¿ƒæ€æƒ³**ï¼šç²¾ç¡®ç¼–è¾‘æ¨¡å‹ä¸­çš„APIçŸ¥è¯†
- **æŠ€æœ¯æ–¹æ¡ˆ**ï¼šROME / MEMIT / çŸ¥è¯†é—å¿˜
- **åˆ›æ–°ç‚¹**ï¼š
  - é¦–æ¬¡å°†çŸ¥è¯†ç¼–è¾‘åº”ç”¨äºä»£ç APIæ›´æ–°
  - è¯„ä¼°ç¼–è¾‘çš„å‡†ç¡®æ€§å’Œå±€éƒ¨æ€§
  - é¿å…å½±å“æ— å…³ä»£ç ç”Ÿæˆèƒ½åŠ›

### æ–¹å‘3ï¸âƒ£: è§„åˆ™ + Promptå·¥ç¨‹ï¼ˆå¿«é€ŸBaselineï¼‰
- **æ ¸å¿ƒæ€æƒ³**ï¼šç»“åˆè§„åˆ™åŒ¹é…å’Œç²¾å¿ƒè®¾è®¡çš„Prompt
- **æŠ€æœ¯æ–¹æ¡ˆ**ï¼šè§„åˆ™åº“ + Chain-of-Thought Prompt
- **åˆ›æ–°ç‚¹**ï¼š
  - ä»æ•°æ®é›†è‡ªåŠ¨æå–æ›´æ–°è§„åˆ™
  - è®¾è®¡ä»£ç ç‰¹å®šçš„Promptæ¨¡æ¿

## ğŸ“Š å®éªŒè¿›åº¦

### âœ… é˜¶æ®µ1ï¼šç¯å¢ƒé…ç½®ï¼ˆå·²å®Œæˆ - 2025-11-05ï¼‰
- [x] æœåŠ¡å™¨é…ç½®ç¡®è®¤ï¼ˆGPU: NVIDIA RTX 3090 24GB, CUDA 11.4ï¼‰
- [x] Gitä»“åº“åˆå§‹åŒ–
- [x] condaç¯å¢ƒåˆ›å»ºï¼ˆapiupdate, Python 3.10ï¼‰
- [x] PyTorchå®‰è£…ï¼ˆ2.x+cu118ï¼Œå…¼å®¹CUDA 11.4ï¼‰
- [x] æ ¸å¿ƒä¾èµ–å®‰è£…ï¼ˆtransformers, peft, datasets, accelerateï¼‰
- [x] é¡¹ç›®ç»“æ„æ­å»º
- [x] ç¯å¢ƒæµ‹è¯•é€šè¿‡

### âœ… é˜¶æ®µ2ï¼šæ•°æ®å’Œæ¡†æ¶å‡†å¤‡ï¼ˆå·²å®Œæˆ - 2025-11-05ï¼‰
- [x] **æ•°æ®é›†åˆ›å»º**ï¼ˆ3ä¸ªè®­ç»ƒæ ·ä¾‹ + 1ä¸ªæµ‹è¯•æ ·ä¾‹ï¼‰
  - pandas: append â†’ concatï¼ˆå‡½æ•°æ›¿æ¢ï¼‰
  - numpy: keepdimså‚æ•°å˜åŒ–
  - requests: timeoutå‚æ•°æ·»åŠ 
  
- [x] **æ ¸å¿ƒæ¨¡å—å®ç°**
  - data_utils.py (95è¡Œ) - æ•°æ®åŠ è½½å·¥å…·
  - rule_extractor.py (87è¡Œ) - è§„åˆ™æå–å™¨ï¼Œ3æ¡è§„åˆ™
  - prompt_engineering.py (107è¡Œ) - 4ç§Promptç­–ç•¥
  - test_phase2.py (209è¡Œ) - å®Œæ•´æµ‹è¯•å¥—ä»¶
  
- [x] **æµ‹è¯•éªŒè¯**
  - âœ… æ•°æ®åŠ è½½æµ‹è¯•é€šè¿‡
  - âœ… è§„åˆ™æå–æµ‹è¯•é€šè¿‡ï¼ˆ3æ¡è§„åˆ™ï¼Œè¦†ç›–3ä¸ªåº“ï¼‰
  - âœ… Promptæ¨¡æ¿æµ‹è¯•é€šè¿‡ï¼ˆåŸºç¡€/ä¸Šä¸‹æ–‡/è§„åˆ™/CoTï¼‰
  - âœ… ç«¯åˆ°ç«¯æµç¨‹éªŒè¯é€šè¿‡
  - âœ… è§„åˆ™åº“ç”Ÿæˆï¼ˆconfigs/rules.json, 572å­—èŠ‚ï¼‰

**é˜¶æ®µ2æˆæœ**ï¼š
```
âœ… æ•°æ®åŠ è½½å™¨: é€šè¿‡ (3 train, 1 test)
âœ… è§„åˆ™æå–å™¨: 3æ¡è§„åˆ™ (pandas/numpy/requests)
âœ… Promptç­–ç•¥: 4ç§ (230-400å­—ç¬¦)
âœ… ç«¯åˆ°ç«¯æµ‹è¯•: å…¨éƒ¨é€šè¿‡
```

### â³ é˜¶æ®µ3ï¼šæ–¹æ³•å®ç°ï¼ˆè¿›è¡Œä¸­ï¼‰
- [ ] **æ–¹å‘1ï¼šLoRAå¾®è°ƒ**
  - [ ] æ¨¡å‹åŠ è½½æµ‹è¯•
  - [ ] æ ‡å‡†LoRAå®ç°
  - [ ] å±‚æ¬¡åŒ–LoRAå®ç°
  
- [ ] **æ–¹å‘2ï¼šçŸ¥è¯†ç¼–è¾‘**
  - [ ] ROMEæ–¹æ³•å®ç°
  - [ ] ç¼–è¾‘æ•ˆæœè¯„ä¼°
  
- [ ] **æ–¹å‘3ï¼šè§„åˆ™+Prompt baseline**
  - [x] è§„åˆ™åº“æ„å»º
  - [x] Promptæ¨¡æ¿è®¾è®¡
  - [ ] å®Œæ•´pipelineå®ç°

### â³ é˜¶æ®µ4ï¼šè¯„ä¼°ä¸åˆ†æï¼ˆå¾…å¼€å§‹ï¼‰
- [ ] ç»Ÿä¸€è¯„ä¼°æ¡†æ¶
- [ ] ä¸‰ä¸ªæ–¹å‘å¯¹æ¯”
- [ ] å¤±è´¥æ¡ˆä¾‹åˆ†æ
- [ ] å®éªŒæŠ¥å‘Šæ’°å†™

## ğŸ› ï¸ æŠ€æœ¯æ ˆ

### æ ¸å¿ƒä¾èµ–
- **Python**: 3.10+
- **PyTorch**: 2.0+ (CUDA 11.4)
- **Transformers**: 4.36.0
- **PEFT**: 0.7.0ï¼ˆLoRAå¾®è°ƒï¼‰
- **EasyEdit**: æœ€æ–°ç‰ˆï¼ˆçŸ¥è¯†ç¼–è¾‘ï¼‰
- **Datasets**: 2.15.0

### ç¡¬ä»¶è¦æ±‚
- **GPU**: è‡³å°‘10GBæ˜¾å­˜ï¼ˆæ¨è24GBï¼‰
- **å®éªŒç¯å¢ƒ**: 2x NVIDIA RTX 3090 (24GB each)

## ğŸ“‚ é¡¹ç›®ç»“æ„

```
api-migration-experiment/
â”œâ”€â”€ data/                      # æ•°æ®é›†
â”‚   â”œâ”€â”€ raw/                   # åŸå§‹æ•°æ®
â”‚   â”œâ”€â”€ processed/             # å¤„ç†åæ•°æ®
â”‚   â””â”€â”€ test/                  # æµ‹è¯•é›†
â”œâ”€â”€ src/                       # æºä»£ç 
â”‚   â”œâ”€â”€ baseline/              # æ–¹å‘3: è§„åˆ™+Prompt
â”‚   â”‚   â”œâ”€â”€ rule_extractor.py      # è§„åˆ™æå–
â”‚   â”‚   â”œâ”€â”€ prompt_engineering.py  # Promptè®¾è®¡
â”‚   â”‚   â””â”€â”€ run_baseline.py        # Baselineè¿è¡Œ
â”‚   â”œâ”€â”€ rl_finetuning/         # æ–¹å‘1: RLå¾®è°ƒ
â”‚   â”‚   â”œâ”€â”€ lora_finetune.py       # LoRAå¾®è°ƒ
â”‚   â”‚   â””â”€â”€ reward_function.py     # å¥–åŠ±å‡½æ•°
â”‚   â”œâ”€â”€ knowledge_editing/     # æ–¹å‘2: çŸ¥è¯†ç¼–è¾‘
â”‚   â”‚   â”œâ”€â”€ run_editing.py         # çŸ¥è¯†ç¼–è¾‘
â”‚   â”‚   â””â”€â”€ evaluate_editing.py    # ç¼–è¾‘è¯„ä¼°
â”‚   â””â”€â”€ utils/                 # å·¥å…·å‡½æ•°
â”‚       â”œâ”€â”€ evaluate.py            # ç»Ÿä¸€è¯„ä¼°
â”‚       â””â”€â”€ data_utils.py          # æ•°æ®å¤„ç†
â”œâ”€â”€ models/                    # æ¨¡å‹æ–‡ä»¶
â”‚   â””â”€â”€ checkpoints/           # è®­ç»ƒæ£€æŸ¥ç‚¹
â”œâ”€â”€ results/                   # å®éªŒç»“æœ
â”‚   â”œâ”€â”€ baseline/              # Baselineç»“æœ
â”‚   â”œâ”€â”€ rl/                    # RLç»“æœ
â”‚   â””â”€â”€ editing/               # ç¼–è¾‘ç»“æœ
â”œâ”€â”€ configs/                   # é…ç½®æ–‡ä»¶
â”‚   â””â”€â”€ rules.json            # APIæ›´æ–°è§„åˆ™åº“
â”œâ”€â”€ scripts/                   # è¿è¡Œè„šæœ¬
â”‚   â”œâ”€â”€ setup_env.sh          # ç¯å¢ƒé…ç½®
â”‚   â”œâ”€â”€ prepare_data.py       # æ•°æ®å‡†å¤‡
â”‚   â””â”€â”€ test_env.py           # ç¯å¢ƒæµ‹è¯•
â”œâ”€â”€ logs/                      # æ—¥å¿—æ–‡ä»¶
â”œâ”€â”€ docs/                      # æ–‡æ¡£
â”‚   â”œâ”€â”€ æ–°æ‰‹å®Œæ•´æŒ‡å—.md
â”‚   â”œâ”€â”€ GitåŒæ­¥æŒ‡å—.md
â”‚   â””â”€â”€ å®éªŒè®°å½•.md
â”œâ”€â”€ .gitignore                # Gitå¿½ç•¥è§„åˆ™
â”œâ”€â”€ README.md                 # é¡¹ç›®è¯´æ˜ï¼ˆæœ¬æ–‡ä»¶ï¼‰
â””â”€â”€ requirements.txt          # Pythonä¾èµ–
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. å…‹éš†é¡¹ç›®
```bash
git clone https://github.com/æ‚¨çš„ç”¨æˆ·å/api-migration-experiment.git
cd api-migration-experiment
```

### 2. åˆ›å»ºç¯å¢ƒ
```bash
# åˆ›å»ºcondaç¯å¢ƒ
conda create -n apiupdate python=3.10 -y
conda activate apiupdate

# å®‰è£…PyTorch (CUDA 11.4)
pip install torch torchvision torchaudio --index-url https://download.pytorch.org/whl/cu113

# å®‰è£…å…¶ä»–ä¾èµ–
pip install transformers==4.36.0 peft==0.7.0 datasets==2.15.0
pip install accelerate bitsandbytes libcst tqdm rich wandb
```

### 3. å‡†å¤‡æ•°æ®
```bash
python scripts/prepare_data.py
```

### 4. æµ‹è¯•ç¯å¢ƒ
```bash
python scripts/test_env.py
```

### 5. è¿è¡Œå®éªŒ

**Baselineæ–¹æ³•**:
```bash
cd src/baseline
python run_baseline.py
```

**LoRAå¾®è°ƒ**:
```bash
cd src/rl_finetuning
python lora_finetune.py
```

**çŸ¥è¯†ç¼–è¾‘**:
```bash
cd src/knowledge_editing
python run_editing.py
```

## ğŸ“ å‚è€ƒè®ºæ–‡

1. **ReCode**: Updating Code API Knowledge with Reinforcement Learning
   - arXiv: 2507.12367
   - æœºæ„: æµ™æ±Ÿå¤§å­¦ & è…¾è®¯AIè¥¿é›…å›¾å®éªŒå®¤

2. **CodeUpdateArena**: Benchmarking Knowledge Editing on API Updates
   - arXiv: 2407.06249
   - æœºæ„: The University of Texas at Austin

3. **GitChameleon 2.0**: Evaluating AI Code Generation Against Python Library Version Incompatibilities
   - arXiv: 2506.20495
   - æœºæ„: ELLIS Institute TÃ¼bingen, Mila Quebec AI Institute, Googleç­‰

### ç›¸å…³å·¥ä½œ
- ROME: Locating and Editing Factual Associations in GPT (NeurIPS 2022)
- MEMIT: Mass-Editing Memory in a Transformer (ICLR 2023)
- LoRA: Low-Rank Adaptation of Large Language Models (ICLR 2022)

## ğŸ“ˆ å®éªŒç»“æœ

### åˆæ­¥ç»“æœï¼ˆæ›´æ–°ä¸­...ï¼‰

| æ–¹æ³• | è¯­æ³•æ­£ç¡®ç‡ | æ‰§è¡ŒæˆåŠŸç‡ | å®Œå…¨åŒ¹é…ç‡ | è®­ç»ƒæ—¶é—´ |
|------|-----------|-----------|-----------|---------|
| Baseline (è§„åˆ™+Prompt) | - | - | - | 0min |
| LoRAå¾®è°ƒ | - | - | - | -min |
| çŸ¥è¯†ç¼–è¾‘ (ROME) | - | - | - | -min |

*æ³¨ï¼šç»“æœå°†åœ¨å®éªŒå®Œæˆåæ›´æ–°*

## ğŸ¤ è´¡çŒ®

æ¬¢è¿æå‡ºé—®é¢˜å’Œå»ºè®®ï¼

## ğŸ“… æ—¶é—´çº¿

- âœ… **2025-11-05**: é¡¹ç›®åˆå§‹åŒ–ï¼ŒGitä»“åº“å»ºç«‹
- âœ… **2025-11-05**: æœåŠ¡å™¨ç¯å¢ƒé…ç½®å®Œæˆï¼ˆGPU RTX 3090, CUDA 11.4ï¼‰
- âœ… **2025-11-05**: condaç¯å¢ƒåˆ›å»ºï¼ˆapiupdate, Python 3.10ï¼‰
- âœ… **2025-11-05**: é˜¶æ®µ1å®Œæˆ - æ‰€æœ‰ä¾èµ–å®‰è£…æˆåŠŸ
- âœ… **2025-11-05**: é˜¶æ®µ2å®Œæˆ - æ•°æ®å’Œæ¡†æ¶å‡†å¤‡ï¼Œæ‰€æœ‰æµ‹è¯•é€šè¿‡
- â³ **è¿›è¡Œä¸­**: é˜¶æ®µ3 - é€‰æ‹©ä¸‹ä¸€æ­¥å®éªŒæ–¹å‘

### è¯¦ç»†æ—¥å¿—
æŸ¥çœ‹ [CHANGELOG.md](CHANGELOG.md) å’Œ [å®éªŒè¿›åº¦è®°å½•](docs/å®éªŒè¿›åº¦è®°å½•.md) è·å–å®Œæ•´çš„æ›´æ–°å†å²ã€‚

## ğŸ“„ è®¸å¯è¯

MIT License

## ğŸ™ è‡´è°¢

æ„Ÿè°¢ä»¥ä¸‹å¼€æºé¡¹ç›®ï¼š
- [Transformers](https://github.com/huggingface/transformers)
- [PEFT](https://github.com/huggingface/peft)
- [EasyEdit](https://github.com/zjunlp/EasyEdit)

---

**å®éªŒè¿›å±•å’Œè¯¦ç»†è®°å½•è¯·æŸ¥çœ‹ [å®éªŒè®°å½•æ–‡æ¡£](docs/å®éªŒè®°å½•.md)**

*Last updated: 2025-11-05*

